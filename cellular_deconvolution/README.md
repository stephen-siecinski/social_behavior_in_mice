# MusiC Cellular Deconvolution

## Background 

This project aimed to improve our RNA-seq and DNA-methyl-seq analyses by estimating the relative proportions of neuronal and non-neuronal cells within our mouse amygdala and hippocampus samples. I accomplished this by using the [MuSiC](https://www.nature.com/articles/s41467-018-08023-x) algorithm paired with the ["Mouse Whole Cortex and Hippocampus 10x"](https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x) dataset from the Allen Brain Atlas. 

MuSiC uses recursive clustering with annotated single-cell datasets to estimate proportions of closely related cell populations (transcriptionally) and then estimates proportions of each of those cell types within the cluster to make final estimates of relative cell proportions within bulk-seq data. Importantly, this algorithm incorporates data from multiple subjects, so the genes used to generate these estimates effectively distinguishing between each cell type while showing cross-individual stability. 

## Description of contents
- cellular_subclass_estimates.Rmd: The script used to generate the sub-class cell-type proportional estimates that were used in the differential expression / methylation models in DESeq2 and RNbeads/DMRseq, respectively.
- MuSiC_results_table.R: A script to summarize the results of the MuSiC estimates and export them as a formatted table.
- MuSiC_sampling_optimization.Rmd: A pipeline used to determine the sampling depth required to achieve stable cell proportion estimates across different randomized seeds. 
- RNAseq_expressionset_object.Rmd: The script used to generate an ExpressionSet object from the bulk-RNA-seq experiments.
- neuroclassification_heatmap.R: Heatmap depicting mouse brain samples clustered by euclidean distance using the estimated sub-class proportional estimates. 
- subset_cells.sh: bash script used to subset the large single-cell reference df based on randomized cell identifiers generated by functions in "cellular_subclass_estimates.Rmd."


Heatmap Depicting the 43 Clustered Sub-Class Annotations Included in the Allen Reference Dataset
![](https://github.com/stephen-siecinski/social_behavior_in_mice/blob/main/cellular_deconvolution/MuSiC_cell_heatmap_20210226.png?raw=true)

A similar diagram of the proportional estimates made for the bulk-RNA-seq data, clearly displaying regional clustering based on the levels of CA3 (hippocampus-specific) neurons. 

![](https://github.com/stephen-siecinski/social_behavior_in_mice/blob/main/cellular_deconvolution/neuro_clustering_heatmap_20210225.png?raw=true)
